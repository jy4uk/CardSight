name: Update TCG Prices

on:
  schedule:
    # Run daily at 6 AM UTC (1 AM EST / 2 AM EDT)
    - cron: '0 6 * * *'
  workflow_dispatch: # Allow manual trigger

jobs:
  update-prices:
    runs-on: ubuntu-latest
    
    steps:
      - name: Trigger price update
        run: |
          curl -X POST "${{ secrets.RAILWAY_BACKEND_URL }}/api/tcg/update-prices" \
            -H "X-API-Key: ${{ secrets.CRON_API_KEY }}" \
            --max-time 300 \
            --retry 3 \
            --retry-delay 10
        env:
          RAILWAY_BACKEND_URL: ${{ secrets.RAILWAY_BACKEND_URL }}
          CRON_API_KEY: ${{ secrets.CRON_API_KEY }}
